<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="/javascripts/lookcontrols.js"></script>
    <script src="/javascripts/mixshader.js"></script>
  </head>
  <body>
    <script>
      var alternate = true;

      AFRAME.registerComponent("onclick-event", {
        init: function() {
          var cam = document.querySelector("#cam");
          var mesh = document.querySelector("#mesh");

          this.el.addEventListener("click", function(e) {
            cam.emit("updateCamPos");
          });
          this.el.addEventListener("animationcomplete__fade", function(e) {
            if (alternate == true) {
              mesh.setAttribute(
                "animation__fade",
                "property: material.u_factor; from: 1.0; to: 0.0; dur: 1000; startEvents: click;"
              );
              cam.setAttribute(
                "animation__Teleport",
                "property: position; from: 0 0 0; to: 0.2 0 0.2; dur: 1000; startEvent: updateCamPos"
              );
              alternate = false;
            } else {
              mesh.setAttribute(
                "animation__fade",
                "property: material.u_factor; from: 0.0; to: 1.0; dur: 1000; startEvents: click;"
              );
              cam.setAttribute(
                "animation__Teleport",
                "property: position; from: 0.2 0 0.2; to: 0 0 0; dur: 1000; startEvent: updateCamPos"
              );
              alternate = true;
            }
          });
        }
      });
    </script>
    <!-- Declaration of the A-Frame scene with permission to use device's gyroscope. -->
    <a-scene device-orientation-permission-ui="enabled: false">
      <!-- Components and shaders go after A-Frame, but before the scene declaration. -->
      <a-assets>
        <img
          id="hotspot1"
          crossorigin="anonymous"
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTJIOgc46myaZ0WqsruFUkyz4NbUOBCjfqMww&usqp=CAU"
        />
        <img
          id="hotspot2"
          crossorigin="anonymous"
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcThk3aLgnBXxPB2pwT0K9SWixM4He0iw1sDhw&usqp=CAU"
        />
      </a-assets>

      <!-- Black skybox at effectively infinite distance. -->
      <!-- a-box is used instead of a-sky because it requires less processing than the sphere that a-sky generates. -->
      <!-- Z scale is inverted so that the inside surface gets the color. -->

      <a-box
        id="mesh"
        width="1"
        height="1"
        depth="1"
        material="shader:mix-shader; 
                  side: back; 
                  u_map1: #hotspot1;
                  u_map1_origin: 0.2 0 0.2;      
                  u_map2: #hotspot2;
                  u_map2_origin: 0 0 0"
        animation__fade="property: material.u_factor; 
                  from: 0.0; 
                  to: 1.0; 
                  dur: 1000; 
                  startEvents: click;"
        onclick-event
      >
      </a-box>

      <a-entity
        id="cam"
        camera
        look-controls
        position="0.2 0 0.2"
        animation__teleport="property: position;
                  from: 0.2 0 0.2;
                  to: 0 0 0;
                  dur: 1000;
                  startEvents: updateCamPos;"
      >
        <a-entity cursor="rayOrigin: mouse"></a-entity>
      </a-entity>
    </a-scene>
  </body>
</html>
